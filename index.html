<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>BorderBound Level Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="drawable/icon_web.svg">

    <!-- Bootstrap CSS (local) -->
    <link rel="stylesheet" href="res/bootstrap.min.css">

    <!-- Custom Dark Mode + Layout -->
    <link rel="stylesheet" href="res/custom.css">

    <!-- jQuery + Popper + Bootstrap JS (local) -->
    <script src="res/jquery.min.js"></script>
    <script src="res/popper.min.js"></script>
    <script src="res/bootstrap.min.js"></script>
    <script src="res/bootstrap.bundle.min.js"></script>
</head>

<body>
    <!-- Toast container -->
    <div id="toastRoot" class="position-fixed top-0 end-0 p-3" style="z-index: 10000;">
        <div id="appToast" class="toast align-items-center border-0" role="alert" aria-live="assertive"
            aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body d-flex align-items-center gap-2">
                    <span id="toastIcon">âœ”</span>
                    <span id="appToastBody"></span>
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
        </div>
    </div>

    <!-- NAVBAR -->
    <nav class="navbar px-3 theme-aware-navbar">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <!-- Left: Brand + Theme Toggle -->
            <div class="d-flex align-items-center">
                <a class="navbar-brand d-flex align-items-center mb-0" href="#">
                    <img src="drawable/icon_web.svg" width="30" height="30" class="me-2">
                    <span class="fs-6 fw-bold">BorderBound! Level Editor</span>
                </a>
                <!-- Theme icon -->
                <span id="themeToggle" class="theme-icon ms-3">ðŸŒ™</span>
            </div>

            <!-- Right: Action Buttons -->
            <div class="d-flex align-items-center">
                <button class="btn btn-sm btn-success me-2" onclick="submitLevel()">Submit</button>
                <button class="btn btn-sm btn-danger" onclick="clearLevel()">Clear</button>
            </div>
        </div>
    </nav>



    <!-- LANDING PAGE -->
    <div id="landingPage" class="container text-center py-5" style="display:none;">
        <h1 class="mb-3 fw-bold">BorderBound Level Editor</h1>
        <p class="lead mb-4 text-muted">Create and share custom levels for BorderBound!</p>

        <div class="d-grid gap-3 col-12 col-md-6 mx-auto">
            <button class="btn btn-dark btn-lg" onclick="startNewLevel(6,5)">Create New Small Level</button>
            <button class="btn btn-warning btn-lg" onclick="startNewLevel(7,6)">Create New Medium Level</button>
            <button class="btn btn-info btn-lg" onclick="startNewLevel(8,6)">Create New Large Level</button>
        </div>
    </div>

    <!-- EDITOR APP -->
    <div id="editorApp" style="display:none;">
        <div class="container p-3">
            <div class="row">
                <!-- BOARD -->
                <div class="col card p-2 m-2">
                    <div class="card-header" id="boardHeader">Game board</div>
                    <div class="card-body" id="boardContainer"></div>
                </div>

                <!-- TOOLBOX -->
                <div class="col card p-2 m-2 toolbox">
                    <div class="card-header">Edit selected position</div>
                    <div class="card-body">

                        <h6>Select type</h6>
                        <table class="m-2">
                            <tr>
                                <!-- EMPTY -->
                                <td>
                                    <div class="field" onclick="setType(TYPE_EMPTY); showToolbox('empty')">
                                        <img src="./drawable/level_box_hole.png">
                                    </div>
                                </td>

                                <!-- FLOW -->
                                <td>
                                    <div class="field" onclick="setType(TYPE_FLOW); showToolbox('flow')">
                                        <img src="./drawable/level_box_color_none.png">
                                        <img src="./drawable/level_box_type_flow.png">
                                    </div>
                                </td>

                                <!-- BOMB -->
                                <td>
                                    <div class="field" onclick="setType(TYPE_BOMB); showToolbox('bomb')">
                                        <img src="./drawable/level_box_color_none.png">
                                        <img src="./drawable/level_box_type_bomb.png">
                                    </div>
                                </td>

                                <!-- LIMIT -->
                                <td>
                                    <div class="field" onclick="setType(TYPE_LIMIT); showToolbox('limit')">
                                        <img src="./drawable/level_box_color_none.png">
                                        <img src="./drawable/level_box_type_limit_up.png">
                                    </div>
                                </td>

                                <!-- NOTHING -->
                                <td>
                                    <div class="field" onclick="setType(TYPE_DISABLED); showToolbox('disabled')">
                                        <img src="./drawable/level_nothing.png">
                                    </div>
                                </td>
                            </tr>
                        </table>

                        <!-- EMPTY TOOLBOX -->
                        <div class="toolbox-item toolbox-item-empty">
                            <h6>Select target color</h6>
                            <table class="m-2">
                                <tr>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_RED)"><img
                                                src="./drawable/level_box_dest_color_red.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_GREEN)"><img
                                                src="./drawable/level_box_dest_color_green.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLUE)"><img
                                                src="./drawable/level_box_dest_color_blue.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_YELLOW)"><img
                                                src="./drawable/level_box_dest_color_yellow.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLACK)"><img
                                                src="./drawable/level_box_dest_color_black.png"></div>
                                    </td>
                                </tr>
                            </table>

                            <h6>Select prefilled color</h6>
                            <table class="m-2">
                                <tr>
                                    <td>
                                        <div class="field" onclick="setPreset(-1)"><img
                                                src="./drawable/level_box_hole.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setPreset(COLOR_RED)"><img
                                                src="./drawable/level_box_hole.png"><img
                                                src="./drawable/level_box_stone_red.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setPreset(COLOR_GREEN)"><img
                                                src="./drawable/level_box_hole.png"><img
                                                src="./drawable/level_box_stone_green.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setPreset(COLOR_BLUE)"><img
                                                src="./drawable/level_box_hole.png"><img
                                                src="./drawable/level_box_stone_blue.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setPreset(COLOR_YELLOW)"><img
                                                src="./drawable/level_box_hole.png"><img
                                                src="./drawable/level_box_stone_yellow.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setPreset(COLOR_BLACK)"><img
                                                src="./drawable/level_box_hole.png"><img
                                                src="./drawable/level_box_stone_black.png">
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- FLOW TOOLBOX -->
                        <div class="toolbox-item toolbox-item-flow">
                            <h6>Select color</h6>
                            <table class="m-2">
                                <tr>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_RED)"><img
                                                src="./drawable/level_box_color_red.png"><img
                                                src="./drawable/level_box_type_flow.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_GREEN)"><img
                                                src="./drawable/level_box_color_green.png"><img
                                                src="./drawable/level_box_type_flow.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLUE)"><img
                                                src="./drawable/level_box_color_blue.png"><img
                                                src="./drawable/level_box_type_flow.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_YELLOW)"><img
                                                src="./drawable/level_box_color_yellow.png"><img
                                                src="./drawable/level_box_type_flow.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLACK)"><img
                                                src="./drawable/level_box_color_black.png"><img
                                                src="./drawable/level_box_type_flow.png"></div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- BOMB TOOLBOX -->
                        <div class="toolbox-item toolbox-item-bomb">
                            <h6>Select color</h6>
                            <table class="m-2">
                                <tr>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_RED)"><img
                                                src="./drawable/level_box_color_red.png"><img
                                                src="./drawable/level_box_type_bomb.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_GREEN)"><img
                                                src="./drawable/level_box_color_green.png"><img
                                                src="./drawable/level_box_type_bomb.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLUE)"><img
                                                src="./drawable/level_box_color_blue.png"><img
                                                src="./drawable/level_box_type_bomb.png">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_YELLOW)"><img
                                                src="./drawable/level_box_color_yellow.png"><img
                                                src="./drawable/level_box_type_bomb.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLACK)"><img
                                                src="./drawable/level_box_color_black.png"><img
                                                src="./drawable/level_box_type_bomb.png"></div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- LIMIT TOOLBOX -->
                        <div class="toolbox-item toolbox-item-limit">
                            <h6>Select color</h6>
                            <table class="m-2">
                                <tr>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_RED)"><img
                                                src="./drawable/level_box_color_red.png"><img
                                                src="./drawable/level_box_type_limit_up.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_GREEN)"><img
                                                src="./drawable/level_box_color_green.png"><img
                                                src="./drawable/level_box_type_limit_up.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLUE)"><img
                                                src="./drawable/level_box_color_blue.png"><img
                                                src="./drawable/level_box_type_limit_up.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_YELLOW)"><img
                                                src="./drawable/level_box_color_yellow.png"><img
                                                src="./drawable/level_box_type_limit_up.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setColor(COLOR_BLACK)"><img
                                                src="./drawable/level_box_color_black.png"><img
                                                src="./drawable/level_box_type_limit_up.png"></div>
                                    </td>
                                </tr>
                            </table>
                            <h6>Select direction</h6>
                            <table class="m-2">
                                <tr>
                                    <td>
                                        <div class="field" onclick="setDirection('up')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_up.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setDirection('down')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_down.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setDirection('left')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_left.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setDirection('right')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_right.png"></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="field" onclick="setDirection('rotate_up')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_rotate_up.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setDirection('rotate_down')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_rotate_down.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setDirection('rotate_left')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_rotate_left.png"></div>
                                    </td>
                                    <td>
                                        <div class="field" onclick="setDirection('rotate_right')"><img
                                                src="./drawable/level_box_color_none.png"><img
                                                src="./drawable/level_box_type_limit_rotate_right.png"></div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="submitLevelModal" tabindex="-1" role="dialog"
                aria-labelledby="submitLevelModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="submitLevelModalLabel">Submit Your Level</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group mb-3">
                                <label for="submitName">Your name (required)</label>
                                <input type="text" class="form-control" id="submitName">
                            </div>

                            <div class="form-group mb-3">
                                <label for="submitEmail">Your email (optional)</label>
                                <input type="email" class="form-control" id="submitEmail">
                            </div>

                            <p>Your level JSON:</p>
                            <pre id="xmlOutput" class="json-output"></pre>

                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="agreeCheck">
                                <label class="form-check-label" for="agreeCheck">
                                    I agree that my level will be included in BorderBound under GPL-3 license.
                                </label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" id="submitFinalBtn">Submit</button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="res/script.js"></script>
</body>

</html>